<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Content Writer - Tulz.net</title>
    <meta name="description"
        content="Generate blog posts, emails, and articles using AI. Bring your own OpenAI API Key.">
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <header>
        <div class="container">
            <nav>
                <a href="../index.html" class="logo">Tulz.net</a>
                <div class="nav-links">
                    <a href="../index.html">Home</a>
                    <a href="../index.html#ai-tools">AI Tools</a>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="tool-container">
            <h1>AI Content Writer</h1>

            <!-- API Key Setup -->
            <div id="key-setup"
                style="background: #f0fdf4; padding: 1rem; border-radius: 0.5rem; border: 1px solid #bbf7d0; margin-bottom: 2rem;">
                <label style="display:block; margin-bottom:0.5rem;">Enter OpenAI API Key</label>
                <div style="display:flex; gap:0.5rem;">
                    <input type="password" id="api-key" placeholder="sk-...">
                    <button class="btn" onclick="saveKey()">Save Key</button>
                </div>
                <p style="font-size:0.8rem; margin-top:0.5rem;">Key is stored locally in your browser.</p>
            </div>

            <div class="input-group">
                <label>Topic or Prompt</label>
                <textarea id="prompt" rows="3"
                    placeholder="Write a blog post about the benefits of cycling..."></textarea>
            </div>

            <div class="input-group">
                <label>Tone</label>
                <select id="tone">
                    <option value="Professional">Professional</option>
                    <option value="Casual">Casual</option>
                    <option value="Funny">Funny</option>
                    <option value="Academic">Academic</option>
                </select>
            </div>

            <button class="btn" onclick="generateText()" id="gen-btn">Generate Content</button>

            <div id="result-area" style="margin-top: 2rem; display: none;">
                <label>Generated Content:</label>
                <textarea id="output" rows="12" readonly></textarea>
                <button class="btn btn-secondary" onclick="copyText()">Copy Text</button>
            </div>
        </div>
    </main>

    <script src="../js/main.js"></script>
    <script>
        const keyInput = document.getElementById('api-key');
        // Load saved key
        const savedKey = localStorage.getItem('openai_key');
        if (savedKey) {
            keyInput.value = savedKey;
            document.getElementById('key-setup').style.display = 'none'; // Hide if saved
        }

        function saveKey() {
            const key = keyInput.value.trim();
            if (key) {
                localStorage.setItem('openai_key', key);
                alert("Key saved!");
                location.reload();
            }
        }

        async function generateText() {
            const apiKey = localStorage.getItem('openai_key');
            if (!apiKey) return alert("Please save your OpenAI API Key first.");

            const prompt = document.getElementById('prompt').value;
            const tone = document.getElementById('tone').value;
            if (!prompt) return alert("Enter a prompt.");

            const btn = document.getElementById('gen-btn');
            btn.disabled = true;
            btn.textContent = "Writing...";

            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: "gpt-3.5-turbo",
                        messages: [{
                            role: "user",
                            content: `Write a ${tone} piece about: ${prompt}`
                        }]
                    })
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error.message);

                const text = data.choices[0].message.content;
                document.getElementById('output').value = text;
                document.getElementById('result-area').style.display = 'block';

            } catch (err) {
                alert("Error: " + err.message);
            }

            btn.disabled = false;
            btn.textContent = "Generate Content";
        }

        function copyText() {
            const output = document.getElementById('output');
            output.select();
            navigator.clipboard.writeText(output.value);
            alert("Copied!");
        }
    </script>
</body>

</html>